import sys
sys.path.append(r"{parent_folder}")

{strategy_code}

def main():
    import os
    from sqlalchemy import update

    from core.enums import TradingPlatform, StrategyType, DeploymentStatus
    from db_models import Deployments
    from utils import get_db_sess_sync
    from lib.exchanges import MT5FuturesExchange
    from lib.order_managers import MT5FuturesOrderManager

    with get_db_sess_sync() as db_sess:
        db_sess.execute(
            update(Deployments)
            .values(status=DeploymentStatus.DEPLOYED.value)
            .where(Deployments.deployment_id == "{deployment_id}")
        )
        db_sess.commit()

    exchange = MT5FuturesExchange({creds})
    om = MT5FuturesOrderManager()
    om._exchange = exchange

    strat = UserStrategy(StrategyType.FUTURES, TradingPlatform.MT5, "{instrument}")
    strat._om = om

    with strat:
        for tick in exchange.subscribe("{instrument}"):
            strat.run(tick)


main()